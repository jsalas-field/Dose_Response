---
title: "Modify Raw Imported Data"
author: "Jonathan Salas"
date: "Last Updated `r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, include = FALSE}
library(dplyr)
library(stringr)
knitr::opts_knit$set(root.dir = "~/R_Projects/Dose_Response")
```

# Import the raw data - Point to the correct raw data directory

```{r}
raw_data_dir <- "data/processed/imported_dr.RData"
```


## Import Subject Data
```{r}
load(raw_data_dir)
```

## Calculate derived statistics

```{r}
cleaned_res <- cleaned_res |>
  mutate(
    depth_per_width = round(depth/diameter,2)
  ) 
```

# Make Analysis Data
 
We exclude the fast-switch data from the 04022024Potato experiment because here we varied ratio of bipolar to unipolar applications to assess depth & diameter. Isn't directly comparable to the bulk of the data

```{r}
working_dat <- cleaned_res |>
  filter(experiment_id == "04022024Potato") |> 
  filter(waveform == "fast-switch") |>
  anti_join(x = cleaned_res)
```

# Save cleaned data

```{r}
save(working_dat, 
     file = paste0("data/processed/working_dr.RData"))
```

# Version and Package Details

```{r echo = F}
paste(version$version.string, version$nickname)
paste0(
  "RStudio Version ",
  rstudioapi::versionInfo()$version,
  " ",
  rstudioapi::versionInfo()$release_name
) # RStudio Version
subset(data.frame(sessioninfo::package_info()),
       attached == TRUE,
       c(package, loadedversion)) # Loaded Packages
```

# When were these files last rewritten?

```{r}
date()
```